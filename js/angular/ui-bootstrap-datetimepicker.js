angular.module("ui.bootstrap.datetimepicker",["ui.bootstrap.dateparser","ui.bootstrap.position"]).constant("uiDatetimePickerConfig",{dateFormat:"dd-MMM-yyyy HH:mm",defaultTime:"00:00:00",html5Types:{date:"yyyy-MM-dd","datetime-local":"yyyy-MM-ddTHH:mm:ss.sss",month:"yyyy-MM"},initialPicker:"date",reOpenDefault:!1,enableDate:!0,enableTime:!0,buttonBar:{show:!0,now:{show:!1,text:"Acum"},today:{show:!0,text:"Azi"},clear:{show:!0,text:"Sterge"},date:{show:!0,text:"Data"},time:{show:!0,text:"Ora"},close:{show:!0,text:"Close"}},closeOnDateSelection:!0,closeOnTimeNow:!0,appendToBody:!1,altInputFormats:[],ngModelOptions:{},saveAs:!1,readAs:!1}).controller("DateTimePickerController",["$scope","$element","$attrs","$compile","$parse","$document","$timeout","$uibPosition","dateFilter","uibDateParser","uiDatetimePickerConfig","$rootScope",function(a,b,c,d,e,f,g,h,i,j,k,l){function y(c){var d=p[0],e=b[0].contains(c.target),f=void 0!==d.contains&&d.contains(c.target);!a.isOpen||e||f||a.$apply(function(){a.close(!1)})}function z(c){27===c.which&&a.isOpen?(c.preventDefault(),c.stopPropagation(),a.$apply(function(){a.close(!1)}),b[0].focus()):40!==c.which||a.isOpen||(c.preventDefault(),c.stopPropagation(),a.$apply(function(){a.isOpen=!0}))}function A(a){return a.replace(/([A-Z])/g,function(a){return"-"+a.toLowerCase()})}function B(b){var c=j.parse(b,m,a.date);if(isNaN(c))for(var d=0;d<v.length;d++)if(c=j.parse(b,v[d],a.date),!isNaN(c))return c;return c}function C(a){if(angular.isNumber(a)&&!isNaN(a)&&(a=new Date(a)),!a)return null;if(angular.isDate(a)&&!isNaN(a))return a;if(angular.isString(a)){var b=B(a);if(!isNaN(b))return j.toTimezone(b,o.timezone)}else;}function D(b){return!(a.datepickerOptions.minDate&&b<a.datepickerOptions.minDate)&&!(a.datepickerOptions.maxDate&&b>a.datepickerOptions.maxDate)}function E(a,b){var d=a||b;return!(c.ngRequired||c.required||d)||(angular.isNumber(d)&&(d=new Date(d)),!d||(angular.isDate(d)&&!isNaN(d)?D(d):angular.isDate(new Date(d))&&!isNaN(new Date(d).valueOf())?D(new Date(d)):!!angular.isString(d)&&(!isNaN(B(b))&&D(B(b)))))}var n,o,p,m=k.dateFormat,q={},r=[],s=angular.isDefined(c.closeOnDateSelection)?a.$parent.$eval(c.closeOnDateSelection):k.closeOnDateSelection,t=angular.isDefined(c.closeOnTimeNow)?a.$parent.$eval(c.closeOnTimeNow):k.closeOnTimeNow,u=angular.isDefined(c.datepickerAppendToBody)?a.$parent.$eval(c.datepickerAppendToBody):k.appendToBody,v=angular.isDefined(c.altInputFormats)?a.$parent.$eval(c.altInputFormats):k.altInputFormats,w=angular.isDefined(c.saveAs)?a.$parent.$eval(c.saveAs)||c.saveAs:k.saveAs,x=angular.isDefined(c.readAs)?a.$parent.$eval(c.readAs):k.readAs;this.init=function(e){function r(a){if(n.$isEmpty(a))return a;var b=new Date(a);return angular.isDate(b)&&!isNaN(b)?b:a}function s(a){return!a||angular.isString(a)||!angular.isDate(a)||isNaN(a)?a:"ISO"===w?a.toISOString():"json"===w?a.toJSON():"number"===w?a.valueOf():g?j.fromTimezone(a,o.timezone).toLocaleString():(m=m.replace(/M!/,"MM").replace(/d!/,"dd"),j.filter(j.fromTimezone(a,o.timezone),m))}if(n=e,o=n.$options||k.ngModelOptions,a.buttonBar=angular.isDefined(c.buttonBar)?a.$parent.$eval(c.buttonBar):k.buttonBar,a.enableDate=angular.isDefined(a.enableDate)?a.enableDate:k.enableDate,a.enableTime=angular.isDefined(a.enableTime)?a.enableTime:k.enableTime,a.initialPicker=angular.isDefined(c.initialPicker)?c.initialPicker:a.enableDate?k.initialPicker:"time",a.reOpenDefault=angular.isDefined(c.reOpenDefault)?c.reOpenDefault:k.reOpenDefault,"date"==a.initialPicker&&!a.enableDate)throw new Error("datetimePicker can't have initialPicker set to date and have enableDate set to false.");a.showPicker=a.enableDate?a.initialPicker:"time";var g=!1;if(k.html5Types[c.type]?(m=k.html5Types[c.type],g=!0):(m=c.datetimePicker||k.dateFormat,c.$observe("datetimePicker",function(a){var b=a||k.dateFormat;if(b!==m&&(m=b,n.$modelValue=null,!m))throw new Error("datetimePicker must have a date format specified.")})),!m)throw new Error("datetimePicker must have a date format specified.");var h=angular.element('<div date-picker-wrap><div uib-datepicker></div></div><div time-picker-wrap><div uib-timepicker style="margin:0 auto"></div></div>');o?(timezone=o.timezone,a.ngModelOptions=angular.copy(o),a.ngModelOptions.timezone=null,a.ngModelOptions.updateOnDefault===!0&&(a.ngModelOptions.updateOn=a.ngModelOptions.updateOn?a.ngModelOptions.updateOn+" default":"default"),h.attr("ng-model-options","ngModelOptions")):timezone=null,h.attr({"ng-model":"date","ng-change":"dateSelection(date)"});var i=angular.element(h.children()[0]);a.datepickerOptions||(a.datepickerOptions={}),g&&"month"===c.type&&(a.datepickerOptions.datepickerMode="month",a.datepickerOptions.minMode="month"),i.attr("datepicker-options","datepickerOptions"),angular.isDefined(a.datepickerOptions.datepickerMode)||(a.datepickerOptions.datepickerMode="day");var l=angular.element(h.children()[1]);a.timepickerOptions||(a.timepickerOptions={});for(var q in a.timepickerOptions)l.attr(A(q),"timepickerOptions."+q);angular.forEach(["minDate","maxDate","initDate"],function(b){a.datepickerOptions[b]&&("minDate"==b?l.attr("min","datepickerOptions.minDate"):"maxDate"==b&&l.attr("max","datepickerOptions.maxDate"))}),g?n.$formatters.push(function(b){return a.date=j.fromTimezone(b,o.timezone),b}):(n.$$parserName="datetime",n.$validators.datetime=E,n.$parsers.unshift(C),n.$formatters.push(function(b){return n.$isEmpty(b)?(a.date=b,b):(a.date=j.fromTimezone(b,o.timezone),m=m.replace(/M!/,"MM").replace(/d!/,"dd"),j.filter(a.date,m))})),w&&(angular.isFunction(w)?n.$parsers.push(w):n.$parsers.push(s),angular.isFunction(x)?n.$formatters.push(x):n.$formatters.push(r)),n.$viewChangeListeners.push(function(){a.date=B(n.$viewValue)}),b.bind("keydown",z),p=d(h)(a),h.remove(),u?f.find("body").append(p):b.after(p)},a.getText=function(b){return a.buttonBar[b].text||k.buttonBar[b].text},a.keydown=function(c){27===c.which&&(a.close(!1),b[0].focus())},a.doShow=function(b){return angular.isDefined(a.buttonBar[b].show)?a.buttonBar[b].show:k.buttonBar[b].show},a.dateSelection=function(d,e){if(a.enableTime&&"time"===a.showPicker&&(d||null!=d)&&(angular.isDefined(a.date)&&null!=a.date||(a.date=new Date),d&&null!=d)){var f=new Date(a.date);f.setHours(d.getHours()),f.setMinutes(d.getMinutes()),f.setSeconds(d.getSeconds()),f.setMilliseconds(d.getMilliseconds()),d=f}if(angular.isDefined(d)){if(!a.date){var g=angular.isDefined(c.defaultTime)?c.defaultTime:k.defaultTime,h=new Date("2001-01-01 "+g);isNaN(h)||null==d||(d.setHours(h.getHours()),d.setMinutes(h.getMinutes()),d.setSeconds(h.getSeconds()),d.setMilliseconds(h.getMilliseconds()))}a.date=d}var f=a.date?i(a.date,m):null;b.val(f),n.$setViewValue(f),s&&("time"!=a.showPicker&&null!=f?a.enableTime?a.open("time"):a.close(!1):t&&"time"===a.showPicker&&null!=f&&"now"===e&&a.close(!1))},a.$watch("isOpen",function(c){if(a.dropdownStyle={display:c?"block":"none"},c){q.openDate=a.date;var d=u?h.offset(b):h.position(b);u?a.dropdownStyle.top=d.top+b.prop("offsetHeight")+"px":a.dropdownStyle.top=void 0,a.dropdownStyle.left=d.left+"px",g(function(){a.$broadcast("uib:datepicker.focus"),f.bind("click",y)},0,!1),a.open(a.showPicker)}else f.unbind("click",y)}),a.isDisabled=function(b){"today"!==b&&"now"!==b||(b=j.fromTimezone(new Date,timezone));var c={};return angular.forEach(["minDate","maxDate"],function(b){a.datepickerOptions[b]?angular.isDate(a.datepickerOptions[b])?c[b]=j.fromTimezone(new Date(a.datepickerOptions[b]),timezone):c[b]=new Date(i(a.datepickerOptions[b],"medium")):c[b]=null}),a.datepickerOptions&&c.minDate&&a.compare(b,c.minDate)<0||c.maxDate&&a.compare(b,c.maxDate)>0},a.compare=function(a,b){return new Date(a.getFullYear(),a.getMonth(),a.getDate())-new Date(b.getFullYear(),b.getMonth(),b.getDate())},a.select=function(b,c){angular.isDefined(c)&&(c.preventDefault(),c.stopPropagation());var d=null;if("today"===b||"now"==b){var f=new Date;angular.isDate(a.date)?(d=new Date(a.date),d.setFullYear(f.getFullYear(),f.getMonth(),f.getDate()),d.setHours(f.getHours(),f.getMinutes(),f.getSeconds(),f.getMilliseconds())):d=f}a.dateSelection(d,b)},a.open=function(b,c){angular.isDefined(c)&&(c.preventDefault(),c.stopPropagation()),g(function(){a.showPicker=b},0),"time"==b&&g(function(){a.date=B(n.$viewValue)},50)},a.close=function(c,d){angular.isDefined(d)&&(d.preventDefault(),d.stopPropagation()),a.isOpen=!1,a.enableDate&&a.enableTime&&(a.showPicker=a.reOpenDefault===!1?"date":a.reOpenDefault),angular.isDefined(c)?a.whenClosed({args:{closePressed:c,openDate:q.openDate||null,closeDate:a.date}}):b[0].focus()},a.$on("$destroy",function(){a.isOpen===!0&&(l.$$phase||a.$apply(function(){a.close()})),r.forEach(function(a){a()}),p.remove(),b.unbind("keydown",z),f.unbind("click",y)})}]).directive("datetimePicker",function(){return{restrict:"A",require:["ngModel","datetimePicker"],controller:"DateTimePickerController",scope:{isOpen:"=?",datepickerOptions:"=?",timepickerOptions:"=?",enableDate:"=?",enableTime:"=?",initialPicker:"=?",reOpenDefault:"=?",whenClosed:"&"},link:function(a,b,c,d){var e=d[0],f=d[1];f.init(e)}}}).directive("datePickerWrap",function(){return{restrict:"EA",replace:!0,transclude:!0,templateUrl:"template/date-picker.html"}}).directive("timePickerWrap",function(){return{restrict:"EA",replace:!0,transclude:!0,templateUrl:"template/time-picker.html"}}),angular.module("ui.bootstrap.datetimepicker").run(["$templateCache",function(a){"use strict";a.put("template/date-picker.html",'<ul class="dropdown-menu dropdown-menu-left datetime-picker-dropdown" ng-if="isOpen && showPicker == \'date\'" ng-style=dropdownStyle style=left:inherit ng-keydown=keydown($event) ng-click="$event.preventDefault(); $event.stopPropagation()"><li style="padding:0 5px 5px 5px" class=date-picker-menu><div ng-transclude></div></li><li style=padding:5px ng-if=buttonBar.show><span class="btn-group pull-left" style=margin-right:10px ng-if="doShow(\'today\') || doShow(\'clear\')"><button type=button class="btn btn-sm btn-info" ng-if="doShow(\'today\')" ng-click="select(\'today\', $event)" ng-disabled="isDisabled(\'today\')">{{ getText(\'today\') }}</button> <button type=button class="btn btn-sm btn-danger" ng-if="doShow(\'clear\')" ng-click="select(\'clear\', $event)">{{ getText(\'clear\') }}</button></span> <span class="btn-group pull-right" ng-if="(doShow(\'time\') && enableTime) || doShow(\'close\')"><button type=button class="btn btn-sm btn-default" ng-if="doShow(\'time\') && enableTime" ng-click="open(\'time\', $event)">{{ getText(\'time\')}}</button> <button type=button class="btn btn-sm btn-success" ng-if="doShow(\'close\')" ng-click="close(true, $event)">{{ getText(\'close\') }}</button></span> <span class=clearfix></span></li></ul>'),a.put("template/time-picker.html",'<ul class="dropdown-menu dropdown-menu-left datetime-picker-dropdown" ng-if="isOpen && showPicker == \'time\'" ng-style=dropdownStyle style=left:inherit ng-keydown=keydown($event) ng-click="$event.preventDefault(); $event.stopPropagation()"><li style="padding:0 5px 5px 5px" class=time-picker-menu><div ng-transclude></div></li><li style=padding:5px ng-if=buttonBar.show><span class="btn-group pull-left" style=margin-right:10px ng-if="doShow(\'now\') || doShow(\'clear\')"><button type=button class="btn btn-sm btn-info" ng-if="doShow(\'now\')" ng-click="select(\'now\', $event)" ng-disabled="isDisabled(\'now\')">{{ getText(\'now\') }}</button> <button type=button class="btn btn-sm btn-danger" ng-if="doShow(\'clear\')" ng-click="select(\'clear\', $event)">{{ getText(\'clear\') }}</button></span> <span class="btn-group pull-right" ng-if="(doShow(\'date\') && enableDate) || doShow(\'close\')"><button type=button class="btn btn-sm btn-default" ng-if="doShow(\'date\') && enableDate" ng-click="open(\'date\', $event)">{{ getText(\'date\')}}</button> <button type=button class="btn btn-sm btn-success" ng-if="doShow(\'close\')" ng-click="close(true, $event)">{{ getText(\'close\') }}</button></span> <span class=clearfix></span></li></ul>')}]);